<Popup>:
    separator_height: 0
    background_color: 9/255, 25/255, 47/255
    title: ""
    title_size: 0

<AsyncImageButton@ButtonBehavior+AsyncImage>:

<MainWidget>:
    canvas.before:
        Color:
            rgb: 9/255, 25/255, 47/255
        Rectangle:
            pos: self.pos
            size: self.size
    
    BoxLayout:
        size: root.size
        orientation: 'vertical'
        padding: [dp(20)]

        Label:
            text: 'Sentiment Analysis on Students Feedback in Campus Events at the City College of Calamba'
            size_hint: 0.95, None
            pos_hint: {'center_x': 0.5 }
            height: dp(40)
            font_size: sp(18)
            bold: True
            color: "#000000"

            canvas.before:
                Color:
                    rgb: 0xF2/255, 0xC1/255, 0x5F/255
                Rectangle:
                    size: self.size
                    pos: self.pos
        
        GridLayout:
            cols: 2
            spacing: dp(20)

            BoxLayout:
                orientation: 'vertical'

                Widget:
                    size_hint_y: None
                    height: dp(30)

                Label:
                    text: 'Upload a CSV File'
                    pos_hint: {'center_x': 0.5 }
                    size_hint_y: None
                    height: dp(40)
                    font_size: sp(36)
                    bold: True
                
                Label:
                    text: 'Please upload the CSV file with the text data'
                    pos_hint: {'center_x': 0.5 }
                    size_hint_y: None
                    height: dp(40)
                    font_size: sp(18)
                
                BoxLayout:
                    orientation: 'vertical'
                    canvas.before:
                        Color:
                            rgb: 0xF2/255, 0xC1/255, 0x5F/255
                        Line:
                            dash_length: 0.5
                            rectangle: self.x, self.y, self.width, self.height
                    
                    Widget:
                        size_hint_y: None
                        height: dp(50)

                    AsyncImageButton:
                        size_hint_y: None
                        height: dp(200)
                        source: "https://static-00.iconduck.com/assets.00/csv-icon-1791x2048-ot22nr8i.png"
                        on_release: root.on_image_click()
                    
                    Widget:
                        size_hint_y: None
                        height: dp(20)
                    
                    Label:
                        text: 'Drag and drop or choose a file to upload your data.'
                        pos_hint: {'center_x': 0.5 }
                        size_hint_y: None
                        height: dp(20)
                        font_size: sp(18)
                        halign: 'center'
                        text_size: self.width, None
                    Label:
                        text: 'All .csv file supported'
                        pos_hint: {'center_x': 0.5 }
                        size_hint_y: None
                        height: dp(20)
                        font_size: sp(18)
                        halign: 'center'
                        text_size: self.width, None
                    
                    Label:
                        text: root.full_comments_file if root.full_comments_file else "[No File Selected]"
                        pos_hint: {'center_x': 0.5 }
                        size_hint_y: None
                        height: dp(40)
                        font_size: sp(18)
                        halign: 'center'
                        text_size: self.width, None
                        color: (134 / 255, 207 / 255, 111 / 255)

                    Widget:
                
                Widget:
                    size_hint_y: None
                    height: dp(20)
                
                Button:
                    text: 'SUBMIT'
                    size_hint_y: None
                    height: dp(40)
                    font_size: sp(32)
                    bold: True
                    color: 9/255, 25/255, 47/255
                    background_normal: ""
                    background_color: 0, 0, 0, 0
                    on_release: root.open_csv()

                    canvas.before:
                        Color:
                            rgb: 0xF2/255, 0xC1/255, 0x5F/255 if self.state != "down" else 212/255, 163/255, 65/255
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
            
            BoxLayout:
                orientation: 'vertical'

                Widget:
                    size_hint_y: None
                    height: dp(30)

                GridLayout:
                    cols: 2
                    StackLayout:
                        orientation: "lr-tb"
                        canvas.before:
                            Color:
                                rgb: 0xF2/255, 0xC1/255, 0x5F/255
                            Line:
                                dash_length: 0.5
                                rectangle: self.x+10, self.y+10, self.width-20, self.height-20
                        Label:
                            text: "Students Engagement"
                            size_hint_y: None
                            height: dp(20)
                            color: "#000000"
                            bold: True

                            canvas.before:
                                Color:
                                    rgb: 0xF2/255, 0xC1/255, 0x5F/255
                                RoundedRectangle:
                                    size: self.width * 0.8, self.height
                                    pos: self.x + self.width * 0.1, self.y
                        FloatLayout:
                            BoxLayout:
                                id: legend
                                orientation: "vertical"
                                spacing: dp(10)
                                size_hint: None, None
                                width: dp(80)
                                height: dp(80)
                                pos: self.parent.x+20, self.parent.y + 160

                                BoxLayout:
                                    orientation: "horizontal"
                                    spacing: dp(10)
                                    Widget:
                                        canvas.before:
                                            Color:
                                                rgb: (134 / 255, 207 / 255, 111 / 255)
                                            RoundedRectangle:
                                                size: self.size
                                                pos: self.pos
                                    Label:
                                        text: str(root.positive_len)
                                BoxLayout:
                                    orientation: "horizontal"
                                    spacing: dp(10)
                                    Widget:
                                        canvas.before:
                                            Color:
                                                rgb: (240 / 255, 137 / 255, 44 / 255)
                                            RoundedRectangle:
                                                size: self.size
                                                pos: self.pos
                                    Label:
                                        text: str(root.neutral_len)
                                BoxLayout:
                                    orientation: "horizontal"
                                    spacing: dp(10)
                                    Widget:
                                        canvas.before:
                                            Color:
                                                rgb: (237 / 255, 106 / 255, 110 / 255)
                                            RoundedRectangle:
                                                size: self.size
                                                pos: self.pos
                                    Label:
                                        text: str(root.negative_len)


                            Widget: 
                                id: engagement_pie
                                size_hint: None, None
                                width: dp(120)
                                height: dp(120)
                                pos: self.parent.x+20, self.parent.y + 110

                    StackLayout:
                        orientation: "lr-tb"
                        canvas.before:
                            Color:
                                rgb: 0xF2/255, 0xC1/255, 0x5F/255
                            Line:
                                dash_length: 0.5
                                rectangle: self.x+10, self.y+10, self.width-20, self.height-20
                        
                        Label:
                            text: "Overall Sentiment"
                            size_hint_y: None
                            height: dp(20)
                            color: "#000000"
                            bold: True

                            canvas.before:
                                Color:
                                    rgb: 0xF2/255, 0xC1/255, 0x5F/255
                                RoundedRectangle:
                                    size: self.width * 0.8, self.height
                                    pos: self.x + self.width * 0.1, self.y
                        Widget:
                            size_hint_y: None
                            height: dp(50)
                        Label:
                            size_hint_y: None
                            height: dp(20)
                            text: root.max_percent_label
                            bold: True
                            color: 
                                (0.52, 0.81, 0.44) if root.max_percent_label == 'POSITIVE' else \
                                (0.75, 0.75, 0.25) if root.max_percent_label == 'NEUTRAL' else \
                                (0.85, 0.25, 0.25)
                        Widget:
                            size_hint_y: None
                            height: dp(10)
                        Label:
                            size_hint_y: None
                            height: dp(60)
                            font_size: dp(84)
                            text: str(root.max_percent) + "%"
                            bold: True
                        Widget:
                BoxLayout:
                    orientation: "vertical"
                    BoxLayout:
                        orientation: "horizontal"
                        spacing: dp(10)
                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: 0.1
                            Widget:
                            AsyncImage:
                                source: "https://cdn1.iconfinder.com/data/icons/round-color-icon/3/30-512.png"
                        BoxLayout:
                            orientation: "vertical"
                            BoxLayout:
                                orientation: "horizontal"
                                Label:
                                    text_size: self.width, None
                                    halign: "left"
                                    text: "Positive"
                                    font_size: sp(16)
                                    bold: True
                                Label:
                                    text_size: self.width, None
                                    halign: "right"
                                    text: str(root.positive_percent) + "%"
                                    font_size: sp(16)
                                    bold: True
                            Widget:
                                canvas.before:
                                    Color:
                                        rgb: (17/255,46/255,83/255)
                                    RoundedRectangle:
                                        size: self.size
                                        pos: self.pos
                                    
                                    Color:
                                        rgb: (134 / 255, 207 / 255, 111 / 255)
                                    RoundedRectangle:
                                        size: self.width/100 * root.positive_percent, self.height
                                        pos: self.pos



                    BoxLayout:
                        orientation: "horizontal"
                        spacing: dp(10)
                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: 0.1
                            Widget:
                            AsyncImage:
                                source: "https://cdn-icons-png.freepik.com/512/8632/8632266.png"
                        BoxLayout:
                            orientation: "vertical"
                            BoxLayout:
                                orientation: "horizontal"
                                Label:
                                    text_size: self.width, None
                                    halign: "left"
                                    text: "Neutral"
                                    font_size: sp(16)
                                    bold: True
                                Label:
                                    text_size: self.width, None
                                    halign: "right"
                                    text: str(root.neutral_percent) + "%"
                                    font_size: sp(16)
                                    bold: True
                            Widget:
                                canvas.before:
                                    Color:
                                        rgb: (17/255,46/255,83/255)
                                    RoundedRectangle:
                                        size: self.size
                                        pos: self.pos
                                    
                                    Color:
                                        rgb: (240 / 255, 137 / 255, 44 / 255)
                                    RoundedRectangle:
                                        size: self.width/100 * root.neutral_percent, self.height
                                        pos: self.pos
                    
                    BoxLayout:
                        orientation: "horizontal"
                        spacing: dp(10)
                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: 0.1
                            Widget:
                            AsyncImage:
                                source: "https://cdn3.iconfinder.com/data/icons/social-messaging-ui-color-shapes-2/128/face-sad-red-512.png"
                        BoxLayout:
                            orientation: "vertical"
                            BoxLayout:
                                orientation: "horizontal"
                                Label:
                                    text_size: self.width, None
                                    halign: "left"
                                    text: "Negative"
                                    font_size: sp(16)
                                    bold: True
                                Label:
                                    text_size: self.width, None
                                    halign: "right"
                                    text: str(root.negative_percent) + "%"
                                    font_size: sp(16)
                                    bold: True
                            Widget:
                                canvas.before:
                                    Color:
                                        rgb: (17/255,46/255,83/255)
                                    RoundedRectangle:
                                        size: self.size
                                        pos: self.pos
                                    
                                    Color:
                                        rgb: (237 / 255, 106 / 255, 110 / 255)
                                    RoundedRectangle:
                                        size: self.width/100 * root.negative_percent, self.height
                                        pos: self.pos

                            
                        
